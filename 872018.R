primary_medulloblastoma_samples_maf <- read.delim("~/Desktop/Data_Analysis/Data_Files/Exome_Data/primary_medulloblastoma_samples_maf.txt", header=FALSE, comment.char="#")
maf_1 <- read.maf(maf = "~/Desktop/Data_Analysis/Data_Files/Exome_Data/primary_medulloblastoma_samples_maf.txt" )
mafSummary(maf_1)
maf_2 <- read.maf(maf = "~/Desktop/Data_Analysis/Data_Files/Exome_Data/recurrent_medulloblastoma_samples_maf.txt" )

####
primary =  subsetMaf(maf_1, tsb = "ABSJ052018CHTN-7-PM")
recurrent =  subsetMaf(maf_2, tsb = "ABSJ052018CHTN-7-RM")
shared = primary$Start_Position[which(primary$Start_Position %in% recurrent$Start_Position)]

primary.shared = subset(primary,primary$Start_Position %in% shared)
recurrent.shared = subset(recurrent,recurrent$Start_Position %in% shared)
primary.uniq = subset(primary,! primary$Start_Position %in% shared)
recurrent.uniq = subset(recurrent,! recurrent$Start_Position %in% shared)

test = rbind(primary,recurrent)
# if you wanted to subset for a minimum depth
min.depth.filter  = 30
primary.uniq.filtered = subset(primary.uniq,primary.uniq$t_depth>=min.depth.filter)


par(mfrow=c(2,2))
par(mar=c(1,1,1,1))
par(oma=c(2,0,0,0))
hist(primary.shared$t_depth,breaks=100,main='Primary Shared',xlim=c(0,120))
hist(recurrent.shared$t_depth,breaks=100,main='Recurrent Shared',xlim=c(0,120))
hist(primary.uniq$t_depth,breaks=100,main='Primary Unique',xlim=c(0,120))
hist(recurrent.uniq$t_depth,breaks=100,main='Recurrent Unique',xlim=c(0,120))

cat('Primary Shared in dbSNP: ',length(which(! primary.shared$dbSNP_RS=='novel')))
cat('Primary Shared NOT dbSNP: ',length(which(primary.shared$dbSNP_RS=='novel')))
cat('Primary Uniq in dbSNP: ',length(which(! primary.uniq$dbSNP_RS=='novel')))
cat('Primary Uniq NOT dbSNP: ',length(which(primary.uniq$dbSNP_RS=='novel')))
cat('Recurrent Uniq in dbSNP: ',length(which(! recurrent.uniq$dbSNP_RS=='novel')))
cat('Recurrent Uniq NOT dbSNP: ',length(which(recurrent.uniq$dbSNP_RS=='novel')))


nrow(ABSJ052018CHTN7PM)






######

ncol(ABSJ052018CHTN7PM)
ABSJ052018CHTN7PM_DF <- as.data.frame(ABSJ052018CHTN7PM)
keep <- 3:(ncol(ABSJ052018CHTN7PM_DF) - 113)

ABSJ052018CHTN7PM_1 <- ABSJ052018CHTN7PM_DF[, keep]
head(ABSJ052018CHTN7PM_1)

maf_2 <- read.maf(maf = "~/Desktop/Data_Analysis/Data_Files/Exome_Data/recurrent_medulloblastoma_samples_maf.txt" )
mafSummary(maf_2)
subsetMaf(maf_1, tsb = "ABSJ052018CHTN-7-RM")
subsetMaf(maf_2, tsb = "ABSJ052018CHTN-7-RM")
ABSJ052018CHTN7RM <- subsetMaf(maf_2, tsb = "ABSJ052018CHTN-7-RM")
nrow(ABSJ052018CHTN7RM)
NCOL(ABSJ052018CHTN7RM)
ABSJ052018CHTN7RM_DF <- as.data.frame(ABSJ052018CHTN7RM)
keep1 <- 3:ncol(ABSJ052018CHTN7RM_DF) - 113)
keep1 <- 3:(ncol(ABSJ052018CHTN7RM_DF) - 113)
ABSJ052018CHTN7RM_1 <- ABSJ052018CHTN7RM_DF[, keep1]
intersect(ABSJ052018CHTN7RM_1$Start_Position,ABSJ052018CHTN7PM_1$Start_Position)
[1]  16048568 153934803  88861557  88861560  90221099 119437075 195779842 195782174 141180333 142384603 142389597 142400325 142469796 149818100
[15] 144355665 120714265  94842866  70952780  72139111  27696863  21523492  21768516  21979011  22148600 105855558  36212343  38335200  63712604
[29]  39877858  54074853  54158305  54219161  35044548  44574611  44580031  77682471 114731326 152727846 154653251     15596   1341593   1654188
[43]   3726395   7242772  12014102  12838525  13382343  16048569  27355949  27379075  27664550  33689074  35438819  37587266  41885734  41885764
[57]  43579794  77924361  96232893 100497924 120793154 145904824 147380844 147519767 147541592 150248944 151867559 152197673 153244336 155933566
[71] 157935941 161853407 165848641 175355383 182402589 200297550 205797032 206450340 206453261 207277951 207785791 210674172 224100172 224217785
[85] 224413208 235460115 244363021 247396314 247605435   9843462  27448390  42492707  66575361  81211720  88966502  90190754  90220982  90221325
[99] 107468239 107468241 109104087 117825360 119258928 119606194 128014233 139965927 162073777 168856574 171236229 194192209 194192224 211414501
[113] 223799918 227745288 229805222 230057598 230149631 241816271   3076322  11540473  12826804  14216164  14216171  14675935  14675936  16001007
[127]  48409892  48419904  48432839  48493138  48565090  57353360  64643753  71106612 100373684 113092320 139554853 146018866 146481576 197703560
197703560
[141]   1057062   1487270   2001907   6644461   7057785   9484419  17999191  20168061  28540138  42035774  43546652  45701021  48885312  52123794
[155]  64567972  66835140  72568663  74455031  74579124  74592674  75876184  81629917  82431024  85510833  87135568 106810243 120697644 121437947
[169] 145140867 146007874 151058314 155645033 156621958 179895182 183407878 183407880 185770130    174126   1036847  17105528  32180971  41004304
[183]  42779584  55410497  73502678  82840245  95283841 167855889 177060392 177081603 178992287   2861250  16599467  17814578  18741290  18741300
[197]  22681236  29942509  42203807  44694475  57555560  57642731  73263056  89816437   2542519   2660053  13876460  20403787  23569150  24392535
[211]  24392542  32538983  33123718  44115266  45723097  57650704  65793639  66760771  67019086  69221764  72807037  73340643  74884776  75052890
[225]  75061324  75069109  75069110  75073392  80237692  83124690  83124707  92997842 101063700 102273527 102283807 102311002 102347216 107128394
[239] 118982191 130508721 130789247 138671985 138671989 142425370 142855480 142861133 142867630 142875988 142925619 142927975 142928154 148710305
[253] 149833805 152881731    658995   2106381   2106405   2143260   4924352   4924359   8613345  17222731  22403275  22569346  26765960  38148813
[267]  41089627  41484614  55905415  80319588 100918409 104785343 113316817 116176123 123423313 139943310 139971438 142273194 144276329 144289233
[281] 144360538 144393647 144397708  29072923  34309109  42452945  65434287  65739412  68995235  71956514  71956532  76193413 105582279 117005207
117005207
[295] 123289145 128126864 133668321 137050057 137257801   2317230   2317234   2545663  14963052  17863686  28069619  28069620  46555938  50210866
[309]  50211182  50211183  59764973  62531325  73367341  80275098  94762804  96942458 101783202 101783203 106616949 119361961 121635069   1075747
[323]   1084524   1086825   1095700   1100845   1185300   1186818   1195112  10285334  10708368  38638090  45094750  61015654  62597206  64227224
[337]  69098623  69917083  71472428  71472431  72004169  72004172  77040541 111615139 118972035 134932163   1840845  11178359  14681488  40548689
[351]  52267408  85025809  92299897  94030516 109092473 120412729 121252745 121959949 121959950 122641329 123284378 124968686 124968689 125098713
[365] 125098714 128814274 128849557 132254286 132254299  18236788  18294474  21916551  21916568  27176389  98774455 111663390 114273771  21499772
[379]  21500477  21768830  22490615  22505082  22515608  22533324  31673338  34524653  36320589  54554919  58202943  72612583  75038313  91545283
[393]  98424814  98963413 101046635 101046637 102085458 104842038 105852010 105864145 105864670 106185099 106443211 106443287 106516499 106601661
[407]  43994602  63530270  64077011  64762363  64762372  64934110  64943413  64955044  64957056  69070884  84944730  98935276   4207280   4207285
[421]   4765601   4854340   9784462  10143802  10143803  15602623  16016396  49477632  55110875  55866639  57882337  57882339  71670695  84099023
[435]  88738517   2695333   3655406   5704064   7513775  21815361  21815368  21816855  21817792  21881399  28389627  28401036  29280882  31484385
[449]  31950197  35937855  36503817  36678848  36942391  37352210  38288151  38318702  38320433  38322505  38323307  38333408  38335482  38337715
[463]  38845729  38850097  41976461  45257286  47104749  48089561  48089570  49262935  51175629  52775719  53110734  57932282  59209845  64334801
[477]  64397693  64426097  67425197  67425203  69182813  71301338  73350208  73350214  73397927  74492235  74492238  75198347  75236326  75754961
[491]  78430637  79651838  79658340  79915725  79915726  80710119  81422014    847888  10508413  10726144  10726145  23371103  51246404  51246409
[505]  61498400  69956673  72841422    643104   1366181   2851299   3393003   3801561   8876672   9558570  10048648  14183477  23878679  35143086
[519]  35143087  36695126  42935542  44026293  44708135  44993387  47027466  48447071  51552993  53721032  54081169  54081979  54087155  54110037
[533]  54168120  54219160  54491960  54533823  54631410  54909442  56087285  56087294    465665    465677   3920217   8548334  16032760  24424323
[547]  25189656  29118212  29416783  30757223  32778942  35467577  35496586  35501831  35501852  35547515  35549142  35560079  54330466  54330503
[561]  58730376  58998541   9591738   9604646  10463053  10617398  10696423  10700296  10701309  30694302  37122970  37250633  42965368  42965373
[575]  46301154  17494347  17735709  22201876  22557485  25514224  25514229  34797220  37635935  41544436  50623899  10175971  18653675  18653676
[589]  44089131  48105041  48917663  48962803  48975236  49017946  49077787  49113797  49179467  72879734 150232453 154468570 154532439  16120677
[603]        73     16399
>
